---
layout: post
title: Pentesting Port - 22 - SSH 
tags: [Pentesting, port22, hacking, ssh]
image: https://ne0wn.github.io/assets/img/test.jpeg
share-img: https://ne0wn.github.io/assets/img/test.jpeg
---

SSH or Secure Shell or Secure Socket Shell, is a network protocol that gives users a secure way to access a computer over an unsecured network.

<center><img src="/assets/img/python_tips/py-joke.jpg" alt="Python Joke"></center>

# Default Port: 22

```shell
22/tcp open  ssh     syn-ack

```

<br>

# SSH Servers:

* [openSSH](http://www.openssh.org/) - OpenBSD SSH, shipped in BSD, Linux distributions and Windows since Windows 10
* [Dropbear](https://matt.ucc.asn.au/dropbear/dropbear.html) - SSH implementation for environments with low memory and processor resources, shipped in OpenWrt
* [PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/) - SSH implementation for Windows, the client is commonly used but the use of the server is rarer
* [CopSSH](https://www.itefix.net/copssh) - implementation of OpenSSH for Windows

<br>

# SSH Libraries (implementing server-side:

* [libSSH](https://www.libssh.org/) - multiplatform C library implementing the SSHv2 protocol with bindings in Python, Perl and R; itâ€™s used by KDE for sftp and by GitHub for the git SSH infrastructure
* [wolfSSH](https://www.wolfssl.com/products/wolfssh/) - SSHv2 server library written in ANSI C and targeted for embedded, RTOS, and resource-constrained environments
* [Apache MINA SSHD](https://mina.apache.org/sshd-project/index.html) - Apache SSHD java library is based on Apache MINA
* [Paramiko](https://github.com/paramiko/paramiko) - Python SSHv2 protocol library

<br>


# Enumeration

## Banner Grabbing


```shell
  nc -vn <IP> 22

```

<br>

## Automated SSH Audit

[SSH-audit](https://github.com/jtesta/ssh-audit) is a tool for ssh server & client configuration auditing.

Features:

* SSH1 and SSH2 protocol server support;
* analyze SSH client configuration;
* grab banner, recognize device or software and operating system, detect compression;
* gather key-exchange, host-key, encryption and message authentication code algorithms;
* output algorithm information (available since, removed/disabled, unsafe/weak/legacy, etc);
* output algorithm recommendations (append or remove based on recognized software version);
* output security information (related issues, assigned CVE list, etc);
* analyze SSH version compatibility based on algorithm information;
* historical information from OpenSSH, Dropbear SSH and libssh;
* runs on Linux and Windows;
* no dependencies

```shell
  
  usage: ssh-audit.py [-1246pbcnjvlt] <host>

   -1,  --ssh1             force ssh version 1 only
   -2,  --ssh2             force ssh version 2 only
   -4,  --ipv4             enable IPv4 (order of precedence)
   -6,  --ipv6             enable IPv6 (order of precedence)
   -p,  --port=<port>      port to connect
   -b,  --batch            batch output
   -c,  --client-audit     starts a server on port 2222 to audit client
                               software config (use -p to change port;
                               use -t to change timeout)
   -n,  --no-colors        disable colors
   -j,  --json             JSON output
   -v,  --verbose          verbose output
   -l,  --level=<level>    minimum output level (info|warn|fail)
   -t,  --timeout=<secs>   timeout (in seconds) for connection and reading
                               (default: 5)
$ python3 ssh-audit <IP>

```
<br>

## Public SSH Key of Server

```shell

ssh-keyscan -t rsa <IP> -p <PORT>

```

<br>

## Weak Cipher Algorithms

This is discovered by default by nmap. But you can also use sslcan or sslyze.

<br>

## Shodan

```shell

ssh

```

<br>

# Brute force usernames, passwords and private keys

## Username Enumeration

In some versions of OpenSSH you can make a timing attack to enumerate users. You can use a metasploit module in order to exploit this:
```shell

msf> use scanner/ssh/ssh_enumusers

```

<br>

## Brute force

Some common ssh credentials here and here and below.

<br>

## Private/Public Keys BF

If you know some ssh private key that could be used... lets try it. You can use the nmap script:

```shell

https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html

```

<br>

Or the MSF auxiliary module:

```shell

msf> use scanner/ssh/ssh_identify_pubkeys

```
<br>

# References:


[FTP Bounce Attack](https://www.thesecuritybuddy.com/vulnerabilities/what-is-ftp-bounce-attack/)
<br>

[Seclists](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt)
<br>


## Thank you for reading.
